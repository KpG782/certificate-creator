---
// filepath: src/components/StudentManagement.astro
---

<div id="student-management-content" class="hidden">
  <div class="space-y-6">
    <!-- Filters & Search -->
    <div class="bg-white rounded-xl shadow-lg p-6">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-2xl font-semibold text-gray-800 flex items-center gap-2">
          <i data-lucide="graduation-cap" class="w-7 h-7"></i>
          Student Certificate Management
        </h2>
        
        <!-- Google Sheets Button -->
        <a
          href="https://docs.google.com/spreadsheets/d/1YC7dMB5rn1pCJjqGRbXgom3xpQN6NRC5YlU7E0nzUT0/edit?gid=0#gid=0"
          target="_blank"
          rel="noopener noreferrer"
          class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition font-medium flex items-center gap-2 shadow-md"
          title="Open Google Sheets to edit student data"
        >
          <i data-lucide="sheet" class="w-5 h-5"></i>
          Open Google Sheets
          <i data-lucide="external-link" class="w-4 h-4"></i>
        </a>
      </div>
      
      <!-- Search Bar -->
      <div class="mb-4">
        <label class="block text-sm font-medium text-gray-700 mb-2">
          <i data-lucide="search" class="w-4 h-4 inline"></i>
          Search by Email
        </label>
        <div class="relative">
          <input 
            type="email" 
            id="email-search" 
            placeholder="Search by email (e.g., maria.santos@umak.edu.ph)" 
            class="w-full px-4 py-3 pl-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
          />
          <i data-lucide="mail" class="w-5 h-5 absolute left-3 top-3.5 text-gray-400"></i>
          <button 
            id="clear-search-btn" 
            class="absolute right-3 top-3 text-gray-400 hover:text-gray-600 hidden"
            title="Clear search"
          >
            <i data-lucide="x" class="w-5 h-5"></i>
          </button>
        </div>
      </div>

      <!-- Filters Row -->
      <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">
            <i data-lucide="calendar" class="w-4 h-4 inline"></i>
            Filter by Year
          </label>
          <select id="year-filter" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
            <option value="">All Years</option>
            <option value="1">1st Year</option>
            <option value="2">2nd Year</option>
            <option value="3">3rd Year</option>
            <option value="4">4th Year</option>
          </select>
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">
            <i data-lucide="users" class="w-4 h-4 inline"></i>
            Filter by Section
          </label>
          <select id="section-filter" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
            <option value="">All Sections</option>
            <option value="1-ACSAD">1-ACSAD</option>
            <option value="1-BCSAD">1-BCSAD</option>
            <option value="2-ACSAD">2-ACSAD</option>
            <option value="2-BCSAD">2-BCSAD</option>
            <option value="3-ACSAD">3-ACSAD</option>
            <option value="3-BCSAD">3-BCSAD</option>
            <option value="4-ACSAD">4-ACSAD</option>
            <option value="4-BCSAD">4-BCSAD</option>
          </select>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">
            <i data-lucide="filter" class="w-4 h-4 inline"></i>
            Filter by Status
          </label>
          <select id="status-filter" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
            <option value="">All Status</option>
            <option value="pending">Pending</option>
            <option value="sent">Sent</option>
            <option value="failed">Failed</option>
          </select>
        </div>

        <div class="flex items-end">
          <button id="refresh-students-btn" class="w-full px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center justify-center gap-2">
            <i data-lucide="refresh-cw" class="w-4 h-4"></i>
            Refresh
          </button>
        </div>
      </div>
    </div>

    <!-- Bulk Actions -->
    <div id="bulk-actions-bar" class="bg-blue-50 border-2 border-blue-200 rounded-xl p-4 hidden">
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-3">
          <i data-lucide="check-square" class="w-5 h-5 text-blue-600"></i>
          <span class="font-semibold text-gray-800">
            <span id="selected-count">0</span> student(s) selected
          </span>
        </div>
        <div class="flex gap-2">
          <button id="bulk-send-btn" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center gap-2 text-sm">
            <i data-lucide="send" class="w-4 h-4"></i>
            Send Certificates
          </button>
          <button id="deselect-all-btn" class="px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition flex items-center gap-2 text-sm">
            <i data-lucide="x" class="w-4 h-4"></i>
            Deselect All
          </button>
        </div>
      </div>
    </div>

    <!-- Students Table -->
    <div class="bg-white rounded-xl shadow-lg p-6">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-xl font-semibold text-gray-800 flex items-center gap-2">
          <i data-lucide="list" class="w-5 h-5"></i>
          Students List
        </h3>
        <div class="flex items-center gap-4">
          <button id="select-all-btn" class="text-sm text-blue-600 hover:text-blue-800 font-medium flex items-center gap-1">
            <i data-lucide="check-square" class="w-4 h-4"></i>
            Select All
          </button>
          <div class="text-sm text-gray-600">
            Total: <span id="total-students" class="font-bold">0</span> students
          </div>
        </div>
      </div>
      
      <div id="students-table-container" class="overflow-auto max-h-[600px]">
        <p class="text-gray-500 text-center py-8">Loading students...</p>
      </div>
    </div>
  </div>
</div>